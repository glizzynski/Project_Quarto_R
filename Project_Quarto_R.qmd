---
title: "Data analysis using R and Quarto"
format: html
editor: visual
---

```{r}
#| label: load-packages
#| include: false

library(tidyverse)
library(palmerpenguins)
library(dplyr)
library(mapview)

data_orig <- read.csv("Crime_data_LA_Prepared.csv", header = TRUE, sep = ";")

gg_color_hue <- function(n) {
  hues = seq(15, 375, length = n + 1)
  hcl(h = hues, l = 65, c = 100)[1:n]
}
```

## Quarto project

Project title: Data analysis using R and Quarto
Author: Student 296356
Subject: Statistical analysis of Los Angeles crime reports
Data source: Los Angeles crime types (based on 2024 data)
(<https://catalog.data.gov/dataset?tags=crime>)

## Most common crime types

Analysis of Los Angeles crime types in 2024 by frequency

```{r fig.height=12, fig.width=14}
#| label: plot-frequency
#| warning: false
#| echo: false

#dim(data_orig)

data_prep <- data_orig %>%
  select(Crm.Cd.Desc,AREA.NAME) %>%
  filter(Crm.Cd.Desc %in% head(names(sort(table(Crm.Cd.Desc), decreasing = TRUE)), 10))

dim(data_prep)

tab <- table(data_prep$AREA.NAME, data_prep$Crm.Cd.Desc)

#totals <- tab %>%                     #  counts of *all* rows per Product
#  count(Crm.Cd.Desc, name = "total")

#tab <- tab %>%                         # keep raw rows for geom_bar()
#  left_join(totals, by = "Crm.Cd.Desc") %>%
#  mutate(Crm.Cd.Desc = fct_reorder(Crm.Cd.Desc, total, .desc = TRUE))

barplot(
  tab,
  col = gg_color_hue(20),
#  col   = c("#1f77b4", "#2ca02c", "#d62728"),  # pick any palette you like
  border = NA,            # clean look â€“ optional
  xlab  = "Crime type",       # adjust to match your x variable
  ylab  = "Number of reported cases",
  main  = "Most common crime types reported",
  legend.text = rownames(tab),
  args.legend = list(x = "topright", bty = "n", inset = 0.02)
)


```
