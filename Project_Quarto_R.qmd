---
title: "Data analysis using R and Quarto"
format: html
editor: visual
---

```{r}
#| label: load-packages
#| include: false

library(tidyverse)
library(palmerpenguins)
library(dplyr)
library(mapview)
library(forcats)
library(scales)

data_orig <- read.csv("Crime_data_LA_Prepared.csv", header = TRUE, sep = ";")

gg_color_hue <- function(n) {
  hues = seq(15, 375, length = n + 1)
  hcl(h = hues, l = 65, c = 100)[1:n]
}
```

## Quarto project

Project title: Data analysis using R and Quarto Author: Student 296356 Subject: Statistical analysis of Los Angeles crime reports Data source: Los Angeles crime types (based on 2024 data) (<https://catalog.data.gov/dataset?tags=crime>)

## Most common crime types

The chart below shows an analysis of Los Angeles crime types in 2024 by frequency.

```{r fig.height=12, fig.width=14}
#| label: plot-frequency
#| warning: false
#| echo: false

data_prep <- data_orig %>%
  select(Crm.Cd.Desc) %>%
  filter(Crm.Cd.Desc %in% head(names(sort(table(Crm.Cd.Desc), decreasing = TRUE)), 20))

ggplot(data_prep) +
  geom_bar(fill = "steelblue", color = "grey20", aes(y = fct_rev(fct_infreq(Crm.Cd.Desc)))) +
  scale_y_discrete(labels = label_wrap(30)) +
  labs(x = "Number of crimes reported", y = "Crime type") +
  theme(
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 20),
    axis.title.x = element_text(margin = margin(t = 12)
    )
  )
```

**Conclusion:** The most common crime type in the LA area in 2004 was vehicle theft (an outstanding number of over 200,000 cases reported). The remaining types of offences are less variable in frequency, and none of them exceeded 100,000.

